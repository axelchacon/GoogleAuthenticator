<!DOCTYPE html>
<html lang="es">
	<head>
		<meta charset="UTF-8" />
		<title>Login MFA</title>
		<style>
			body {
				font-family: Arial, sans-serif;
				max-width: 400px;
				margin: auto;
				padding: 2rem;
			}
			input,
			button {
				width: 100%;
				padding: 0.5rem;
				margin: 0.5rem 0;
			}
			.msg {
				margin-top: 1rem;
				font-weight: bold;
			}
		</style>
	</head>
	<body>
		<h2>Login con MFA</h2>
		<form id="loginForm">
			<input type="email" placeholder="Email" id="email" required />
			<input type="password" placeholder="Contraseña" id="password" required />
			<input
				type="text"
				placeholder="Código Google Authenticator"
				id="token2fa"
				required />
			<button type="submit">Iniciar sesión</button>
		</form>
		<div class="msg" id="msg"></div>

		<script>
			const form = document.getElementById("loginForm");
			form.addEventListener("submit", async (e) => {
				e.preventDefault();
				const email = document.getElementById("email").value;
				const password = document.getElementById("password").value;
				const token2fa = document.getElementById("token2fa").value;

				const res = await fetch("/login", {
					method: "POST",
					headers: { "Content-Type": "application/json" },
					body: JSON.stringify({ email, password, token2fa }),
				});

				const data = await res.json();
				document.getElementById("msg").textContent = data.msg;
				document.getElementById("msg").style.color = res.ok ? "green" : "red";
			});
		</script>
	</body>
</html>
